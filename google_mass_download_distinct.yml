title: Google Drive Download Distinct (High Risk Users) - API
id: 664dc895-3e3a-48b0-940e-c556e931g347
status: enabled
description: Detection for high risk users downloading files count
alerts_enabled: false
alerts_confidence_threshold: very_unlikely
attack_techniques: []
cluster_attributes:
  - actor_email
display_attributes:
  - actor_email
lead_summary_template: "{actor_email} may have possibly downloaded multiple files"
lead_cluster_summary_template: "{actor_email} may have possibly downloaded multiple files"
confidence: possible
severity: moderate

detection:
  type: raw_sql_auto
  refresh_interval: 30m
  sql: |
    SELECT
      MIN(ID_TIME) AS start_time,
      MAX(ID_TIME) AS end_time,
      MAX(METADATA$INSERTION_TIME) AS last_event_insertion_time,
      OBJECT_CONSTRUCT_KEEP_NULL(
        'GSUITE_ACTIVITY',
        ARRAY_AGG(DISTINCT METADATA$UUID)
      ) AS event_ids,
      ARRAY_AGG(DISTINCT METADATA$DATAFLOW_ID) AS dataflow_ids,
      ACTOR_EMAIL,
      COUNT(DISTINCT EVENT_PARAMETERS:doc_id::varchar) AS distinct_file_count,
      COUNT(*) AS total_downloads
    FROM GSUITE_ACTIVITY
    WHERE
      EVENT_NAME = 'download'
      AND EVENT_PARAMETERS:originating_app_id IS NULL
      AND ACTOR_EMAIL IN (
        'abhishek.bhatnagar@onepeloton.com',
        'adam.martin@onepeloton.com',
        'adheeb.ghazali@onepeloton.com',
        'alberto.rejman@onepeloton.com',
        'alex.fuoco@onepeloton.com',
        'amata.lee@onepeloton.com',
        'amna.imam@onepeloton.com',
        'ann.macdonald@onepeloton.com',
        'ann.olson@onepeloton.com',
        'apostolos.kottas@onepeloton.com',
        'aravind.krishnakumar@onepeloton.com',
        'arnav.kapila@onepeloton.com',
        'arunima.thakur@onepeloton.com',
        'bailey.peng@onepeloton.com',
        'beata.steffkova@onepeloton.com',
        'becky.williams@onepeloton.com',
        'ben.baruch@onepeloton.com',
        'ben.wang@onepeloton.com',
        'benjamin.mccain@onepeloton.com',
        'brandon.harmon@onepeloton.com',
        'brenton.reeder@onepeloton.com',
        'bret.ragan@onepeloton.com',
        'brian.nguyen@onepeloton.com',
        'brian.rodowicz@onepeloton.com',
        'bryan.hatfield@onepeloton.com',
        'carlos.frias@onepeloton.com',
        'caroline.downes@onepeloton.com',
        'caylin.payne@onepeloton.com',
        'charlie.kariampuzha@onepeloton.com',
        'christian.oberheide@onepeloton.com',
        'christine.liu@onepeloton.com',
        'cj.charbonneau@onepeloton.com',
        'claudia.pan@onepeloton.com',
        'conner.tate@onepeloton.com',
        'connor.green@onepeloton.com',
        'dagm.assefa@onepeloton.com',
        'dan.hu@onepeloton.com',
        'daniel.hahn@onepeloton.com',
        'danielle.cosh@onepeloton.com',
        'danny.dunbar@onepeloton.com',
        'david.antanavige@onepeloton.com',
        'david.barr@onepeloton.com',
        'deanna.kovalcin@onepeloton.com',
        'diana.vera@onepeloton.com',
        'drew.hinderhofer@onepeloton.com',
        'durgamahadev.rachabattuni@onepeloton.com',
        'elise.vickery@onepeloton.com',
        'ethan.strickland@onepeloton.com',
        'eugene.lee@onepeloton.com',
        'fabian.graham@onepeloton.com',
        'frances.coy@onepeloton.com',
        'frankie.ziman@onepeloton.com',
        'gerry.liu@onepeloton.com',
        'guru.venkatesan@onepeloton.com',
        'haley.jena@onepeloton.com',
        'hariharan.p@onepeloton.com',
        'hassan.raja@onepeloton.com',
        'hayley.caslin@onepeloton.com',
        'henil.patel@onepeloton.com',
        'henry.levy@onepeloton.com',
        'hoyin.wan@onepeloton.com',
        'ian.campo@onepeloton.com',
        'ibrahim.al-rajhi@onepeloton.com',
        'isaac.owusu-addai@onepeloton.com',
        'isha.chawla@onepeloton.com',
        'jack.poon@onepeloton.com',
        'jacquelyn.gallegos@onepeloton.com',
        'jake.marturella-jaramillo@onepeloton.com',
        'james.cho@onepeloton.com',
        'james.clevenger@onepeloton.com',
        'james.sedlacek@onepeloton.com',
        'janina.zeta@onepeloton.com',
        'jared.fowler@onepeloton.com',
        'jason.deville@onepeloton.com',
        'jason.kelly@onepeloton.com',
        'jaswanthi.kolla@onepeloton.com',
        'jayashree.venkataswamy@onepeloton.com',
        'jeeva.marimuthu@onepeloton.com',
        'jevan.mure@onepeloton.com',
        'jeremy.satterfield@onepeloton.com',
        'jerry.hsieh@onepeloton.com',
        'jim.yang1@onepeloton.com',
        'jingyi.liu@onepeloton.com',
        'joan.fernandez@onepeloton.com',
        'joe.derosa@onepeloton.com',
        'joe.lee@onepeloton.com',
        'joe.morrison@onepeloton.com',
        'joe.saulenas@onepeloton.com',
        'john.kishkeh@onepeloton.com',
        'john.wesley@onepeloton.com',
        'jose.vila@onepeloton.com',
        'joseph.dinsmore@onepeloton.com',
        'joseph.serignese@onepeloton.com',
        'joseph.silewicz@onepeloton.com',
        'joshua.lindsey@onepeloton.com',
        'juan.guerra@onepeloton.com',
        'julia.cahn@onepeloton.com',
        'justine.mcgrath@onepeloton.com',
        'karina.ferguson@onepeloton.com',
        'karon.ford@onepeloton.com',
        'kat.hollister@onepeloton.com',
        'kate.arcell@onepeloton.com',
        'katherine.flores@onepeloton.com',
        'katie.david@onepeloton.com',
        'kaylee.melo@onepeloton.com',
        'kendal.bessette@onepeloton.com',
        'kenneth.pierre@onepeloton.com',
        'kevin.rabell@onepeloton.com',
        'kiefier.hunter@onepeloton.com',
        'kimberly.mccarty@onepeloton.com',
        'kirthika.kiran@onepeloton.com',
        'kirti.motwani@onepeloton.com',
        'kishantie.ramprasad@onepeloton.com',
        'krishna.nagaraj@onepeloton.com',
        'kristie.cody@onepeloton.com',
        'lakshmipriya.deepakraj@onepeloton.com',
        'lalith.kishore@onepeloton.com',
        'larry.cerpas@onepeloton.com',
        'lars.peterson@onepeloton.com',
        'laura.cantu@onepeloton.com',
        'lauren.joseph@onepeloton.com',
        'lauren.mazzo@onepeloton.com',
        'laxmi.kumari@onepeloton.com',
        'lester.han@onepeloton.com',
        'lexington.high@onepeloton.com',
        'ln.srinivasan@onepeloton.com',
        'logeshkumar.ramalingam@onepeloton.com',
        'lori.resnick@onepeloton.com',
        'maddy.berman@onepeloton.com',
        'madhumitha.kamalakannan@onepeloton.com',
        'mahesh.madhavan@onepeloton.com',
        'makon.cline@onepeloton.com',
        'malika.jackson@onepeloton.com',
        'manikandan.kannan@onepeloton.com',
        'manisha.momula@onepeloton.com',
        'manoaj.kandiakounder@onepeloton.com',
        'mark.bello@onepeloton.com',
        'mark.hu@onepeloton.com',
        'mason.wong@onepeloton.com',
        'matt.grant@onepeloton.com',
        'matthew.fields@onepeloton.com',
        'max.fallan@onepeloton.com',
        'may.wu@onepeloton.com',
        'meleleng.tchalim@onepeloton.com',
        'melissa.rudofsky@onepeloton.com',
        'mia.mcduffie@onepeloton.com',
        'michel.ercia@onepeloton.com',
        'mike.scott@onepeloton.com',
        'mitch.ionescu@onepeloton.com',
        'mohan.venkatesan@onepeloton.com',
        'Monika.Debkowska@onepeloton.com',
        'nagalaxmi.sama@onepeloton.com',
        'nagaraj.venkatesan@onepeloton.com',
        'nam.pham@onepeloton.com',
        'nelson.nguyen@onepeloton.com',
        'nick.henry@onepeloton.com',
        'nicolas.rozo@onepeloton.com',
        'nicolas.webb@onepeloton.com',
        'nidhi.vellanki@onepeloton.com',
        'nikita.goyal@onepeloton.com',
        'oleg.balakirev@onepeloton.com',
        'oliver.sheu@onepeloton.com',
        'omer.sagi@onepeloton.com',
        'pamela.roake@onepeloton.com',
        'patrick.fink@onepeloton.com',
        'paul.blieka@onepeloton.com',
        'paul.shynin@onepeloton.com',
        'peter.finnen@onepeloton.com',
        'peter.kotov@onepeloton.com',
        'peter.kreider@onepeloton.com',
        'peter.severino@onepeloton.com',
        'phyllis.hodges@onepeloton.com',
        'praveen.kumar@onepeloton.com',
        'priyank.dixit@onepeloton.com',
        'radames.sanchez@onepeloton.com',
        'raji.gullapalli@onepeloton.com',
        'rebecca.badger@onepeloton.com',
        'renu.chudamani@onepeloton.com',
        'rick.sun@onepeloton.com',
        'robert.torres@onepeloton.com',
        'roberta.minardi@onepeloton.com',
        'rohan.sapkal@onepeloton.com',
        'ronnie.duarte@onepeloton.com',
        'rose.sahagun@onepeloton.com',
        'rosemary.arnold@onepeloton.com',
        'ryan.luk@onepeloton.com',
        'ryan.zucker@onepeloton.com',
        'sachin.shah@onepeloton.com',
        'sai.vasireddy@onepeloton.com',
        'sam.shapiro@onepeloton.com',
        'sandeep.jagadeesh@onepeloton.com',
        'sandesh.mathew@onepeloton.com',
        'santhosh@onepeloton.com',
        'santhya.k@onepeloton.com',
        'sara.angle@onepeloton.com',
        'sarathkumar.balathandauthapani@onepeloton.com',
        'sariah.grant@onepeloton.com',
        'sathish.puliboina@onepeloton.com',
        'satish.rane@onepeloton.com',
        'saw.po@onepeloton.com',
        'sharmin.rupa@onepeloton.com',
        'sharrell.halley@onepeloton.com',
        'shashank.t@onepeloton.com',
        'shashi.ranjan@onepeloton.com',
        'shelley.soucy@onepeloton.com',
        'shikhar.johri@onepeloton.com',
        'shinji.homawoo@onepeloton.com',
        'shirley.wang@onepeloton.com',
        'shreyeshi.somya@onepeloton.com',
        'shruti.asthana@onepeloton.com',
        'shveta.puri@onepeloton.com',
        'shyam.patel@onepeloton.com',
        'sinthiya.thangavel@onepeloton.com',
        'siobhan.brooker@onepeloton.com',
        'spencer.roda@onepeloton.com',
        'spoorthy.vemula@onepeloton.com',
        'stephanie.dellorusso@onepeloton.com',
        'stephen.joseph@onepeloton.com',
        'stephen.kurniawan@onepeloton.com',
        'steven.diaz@onepeloton.com',
        'steven.jimenez@onepeloton.com',
        'steven.sanbeg@onepeloton.com',
        'sylvia.doku@onepeloton.com',
        'synna.kent@onepeloton.com',
        'tanmay.sharma@onepeloton.com',
        'taylor.curry@onepeloton.com',
        'teyva.chee@onepeloton.com',
        'tiffany.wan@onepeloton.com',
        'tim.ho@onepeloton.com',
        'tk.taneja@onepeloton.com',
        'tommy.carrascal@onepeloton.com',
        'tommy.trinh@onepeloton.com',
        'tracy.gevedon@onepeloton.com',
        'travis.haagen@onepeloton.com',
        'travis.tamez@onepeloton.com',
        'trusha.patel@onepeloton.com',
        'vaibhav.sharma@onepeloton.com',
        'vaishnavi.hemanathan@onepeloton.com',
        'vanessa.johnson@onepeloton.com',
        'vy.phan@onepeloton.com',
        'will.armstrong1@onepeloton.com',
        'will.gambling@onepeloton.com',
        'will.paris@onepeloton.com',
        'xiaoming.huang@onepeloton.com',
        'yarick.ventura@onepeloton.com',
        'yash.gugale@onepeloton.com',
        'yiming.chen@onepeloton.com',
        'zhichen.wang@onepeloton.com'
      )
    GROUP BY ACTOR_EMAIL
    HAVING COUNT(*) > 1

  tables:
    time_tracked_table:
      name: GSUITE_ACTIVITY
